(this["webpackJsonpmyreads-app"]=this["webpackJsonpmyreads-app"]||[]).push([[0],{28:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),c=n(22),s=n.n(c),a=n(11),i=n(2),u=(n(28),n(5)),l=n.n(u),h=n(9),b=n(3),f=n(12),d=function(){var e=Object(h.a)(l.a.mark((function e(t){var n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o in n=[],t)-1===n.indexOf(t[o].shelf)&&n.push(t[o].shelf);return e.abrupt("return",n.map((function(e){return t.filter((function(t){return e===t.shelf}))})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(e){return"undefined"!==typeof e&&e.length>0?e.toString().replace(","," and "):"uknown author"},p="https://reactnd-books-api.udacity.com",O=localStorage.token;O||(O=localStorage.token=Math.random().toString(36).substr(-8));var k={Accept:"application/json",Authorization:O},v=function(){return fetch("".concat(p,"/books"),{headers:k}).then((function(e){return e.json()})).then((function(e){return e.books}))},x=function(e,t){return fetch("".concat(p,"/books/").concat(e),{method:"PUT",headers:Object(b.a)(Object(b.a)({},k),{},{"Content-Type":"application/json"}),body:JSON.stringify({shelf:t})}).then((function(e){return e.json()}))},m=n(1),g={booksShelf:[],books:[],refreshBooks:!1,setBooks:function(){},setBooksShelf:function(){},setState:function(){},refresh:function(){},getAllBooks:function(){return{books:[],booksShelf:[]}}},y=Object(o.createContext)(g),S=function(e){var t=e.children,n=Object(o.useState)(g),c=Object(f.a)(n,2),s=c[0],a=c[1],i=s.books,u=s.booksShelf,j=s.refreshBooks,p=function(e){a((function(t){return Object(b.a)(Object(b.a)({},t),{},{refreshBooks:e})}))},O=function(){var e=Object(h.a)(l.a.mark((function e(){var t,n,o=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!(!(o.length>0&&void 0!==o[0])||o[0])&&u.length>0&&u.length>0)){e.next=5;break}return e.abrupt("return",{booksShelf:u,books:i});case 5:return e.next=7,v();case 7:return t=e.sent,e.next=10,d(t);case 10:return n=e.sent,a((function(e){return Object(b.a)(Object(b.a)({},e),{},{books:t,booksShelf:n})})),e.abrupt("return",{booksShelf:n,books:t});case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.useEffect((function(){(function(){var e=Object(h.a)(l.a.mark((function e(t){var n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t&&u.length>0&&u.length>0)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,v();case 6:return n=e.sent,e.next=9,d(n);case 9:o=e.sent,a((function(e){return Object(b.a)(Object(b.a)({},e),{},{books:n,booksShelf:o})}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}})()(j),j&&p(!1)}),[j,u]),Object(m.jsx)(y.Provider,{value:{books:i,booksShelf:u,setBooks:function(e){a((function(t){return Object(b.a)(Object(b.a)({},t),{},{books:e})}))},setBooksShelf:function(e){a((function(t){return Object(b.a)(Object(b.a)({},t),{},{booksShelf:e})}))},setState:a,refreshBooks:j,refresh:p,getAllBooks:O},children:t})},N={shelf:""};function w(e,t){switch(t.type){case"changeShelf":return{shelf:t.payload};default:throw new Error}}var B=function(e){var t=e.bookID,n=e.bookShelf,r=Object(o.useReducer)(w,N),c=Object(f.a)(r,2),s=c[0],a=c[1],i=s.shelf,u=Object(o.useContext)(y),b=function(){var e=Object(h.a)(l.a.mark((function e(n){var o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.target.value,e.next=3,x(t,o);case 3:u.refresh(!0),a({type:"changeShelf",payload:o});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(o.useEffect)((function(){a({type:"changeShelf",payload:n})}),[n]),Object(m.jsx)("div",{className:"book-shelf-changer",children:Object(m.jsxs)("select",{onChange:b,value:"undefined"!==typeof i?i:"none",children:[Object(m.jsx)("option",{value:"move",disabled:!0,children:"Move to..."}),Object(m.jsx)("option",{value:"currentlyReading",children:"Current Reading"}),Object(m.jsx)("option",{value:"wantToRead",children:"Want to Read"}),Object(m.jsx)("option",{value:"read",children:"Read"}),Object(m.jsx)("option",{value:"none",children:"None"})]})})},C=r.a.memo(B),T=function(e){var t=e.bookID,n=e.title,o=e.author,r=e.image,c=e.shelf;return Object(m.jsxs)("div",{className:"book",children:[Object(m.jsxs)("div",{className:"book-top",children:[Object(m.jsx)("div",{className:"book-cover",style:{width:128,height:192,backgroundImage:"url(".concat(r,")")}}),Object(m.jsx)(C,{bookID:t,bookShelf:c})]}),Object(m.jsx)("div",{className:"book-title",children:n}),Object(m.jsx)("div",{className:"book-authors",children:o})]})},I=function(e){var t=e.shelfName,n=e.books;return Object(m.jsxs)("div",{className:"bookshelf",children:[Object(m.jsx)("h2",{className:"bookshelf-title",children:t}),Object(m.jsx)("div",{className:"bookshelf-books",children:Object(m.jsx)("ol",{className:"books-grid",children:n.map((function(e,n){var o;return Object(m.jsx)("li",{children:Object(m.jsx)(T,{bookID:e.id,shelf:e.shelf,title:null===e||void 0===e?void 0:e.title,author:j(e.authors),image:null===e||void 0===e||null===(o=e.imageLinks)||void 0===o?void 0:o.thumbnail})},"book".concat(t).concat(null===e||void 0===e?void 0:e.title).concat(n))}))})})]})},R=function(){var e=Object(o.useContext)(y).booksShelf;return Object(m.jsxs)("div",{className:"list-books",children:[Object(m.jsx)("div",{className:"list-books-title",children:Object(m.jsx)("h1",{children:"MyReads"})}),Object(m.jsx)("div",{className:"list-books-content",children:"undefined"!==typeof e&&e.length>0?e.map((function(e,t){return Object(m.jsx)(I,{shelfName:e[0].shelf,books:e},"shelf".concat(t))})):Object(m.jsx)("span",{children:"Sorry but We don't find any book or shelf in your list"})}),Object(m.jsx)("div",{className:"open-search",children:Object(m.jsx)(a.b,{to:"/search",children:Object(m.jsx)("button",{children:"Add a book"})})})]})},A=r.a.memo(R),D=n(19),E={books:[],searchText:"",searchedBooks:[]},L=function(e){var t=Object(o.useState)(E),n=Object(f.a)(t,2),r=n[0],c=n[1],s=Object(o.useContext)(y),i=r.searchText,u=r.searchedBooks,d=s.books;return Object(o.useEffect)((function(){var e=!0;return function(){var t=Object(h.a)(l.a.mark((function t(){var n,o,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.length>0&&(n=d.filter((function(e){var t=i.toLowerCase().replace(/[\\]/g,""),n=e.title.toLowerCase(),o=null===e||void 0===e?void 0:e.authors[0].toLowerCase();return-1!==n.search(t)||-1!==o.search(t)})),o=n.map((function(e){return e.id})),r=n,(s=i,fetch("".concat(p,"/search"),{method:"POST",headers:Object(b.a)(Object(b.a)({},k),{},{"Content-Type":"application/json"}),body:JSON.stringify({query:s})}).then((function(e){return e.json()})).then((function(e){return e.books}))).then((function(t){"undefined"!==typeof t&&t.length>1&&(r=[].concat(Object(D.a)(r),Object(D.a)(t)).filter((function(e){return!(-1!==o.indexOf(e.id)&&"undefined"===typeof e.shelf)}))),e&&c((function(e){return Object(b.a)(Object(b.a)({},e),{},{searchedBooks:r})}))})));case 1:case"end":return t.stop()}var s}),t)})));return function(){return t.apply(this,arguments)}}()(),function(){e=!1}}),[i,d]),Object(m.jsxs)("div",{className:"search-books",children:[Object(m.jsxs)("div",{className:"search-books-bar",children:[Object(m.jsx)(a.b,{to:"/",children:Object(m.jsx)("button",{className:"close-search",children:"Close"})}),Object(m.jsx)("div",{className:"search-books-input-wrapper",children:Object(m.jsx)("input",{type:"text",placeholder:"Search by title or author",onChange:function(e){var t="".concat(e.target.value);c((function(e){return Object(b.a)(Object(b.a)({},e),{},{searchText:t})}))}})})]}),Object(m.jsx)("div",{className:"search-books-results",children:Object(m.jsx)("ol",{className:"books-grid",children:"undefined"!==typeof i&&i.length>2&&"undefined"!==typeof u&&u.length>0&&u.map((function(e,t){var n;return Object(m.jsx)("li",{children:Object(m.jsx)(T,{bookID:e.id,title:e.title,author:j(null===e||void 0===e?void 0:e.authors),shelf:null===e||void 0===e?void 0:e.shelf,image:null===e||void 0===e||null===(n=e.imageLinks)||void 0===n?void 0:n.thumbnail})},"search".concat(e.title).concat(t))}))})})]})},J=r.a.memo(L),M=function(){return Object(m.jsx)(a.a,{children:Object(m.jsx)("div",{className:"app",children:Object(m.jsxs)(S,{children:[Object(m.jsx)(i.a,{path:"/search",component:J}),Object(m.jsx)(i.a,{path:"/reactnd-project-myreads-starter",component:A}),Object(m.jsx)(i.a,{exact:!0,path:"/",component:A})]})})})};n(36);s.a.render(Object(m.jsx)(M,{}),document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.af2461ef.chunk.js.map